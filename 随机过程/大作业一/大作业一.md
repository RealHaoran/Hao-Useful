## 大作业一：雷达量测生成器

### 一、问题描述

在现代雷达信息处理中，接收到的量测数据可能来源于真实目标，也可能来源于环境中的不相关源，后者通常被称为**杂波**（Clutter）。为了区分目标信号与杂波，提高目标检测和跟踪的准确性，需对量测数据的生成机制进行建模和分析。

在本报告中，假设每一个时刻雷达仅产生一个二维量测点 $z$，该量测可能来源于目标或杂波。具体建模如下：

- 若量测来自**目标**，则其服从二维正态分布：
  $$
  z \sim \mathcal{N}([0,0]^T, \text{diag}(25, 25))
  $$
  其中 $\text{diag}(25, 25)$ 表示协方差矩阵为对角阵，反映出目标测量在两个维度上具有独立且相等的方差。

- 若量测来自**杂波**，则其服从二维均匀分布：
  $$
  z \sim \mathcal{U}([-10, -10], [10, 10])
  $$
  表示在 $[-10,10] \times [-10,10]$ 的区域内均匀分布，模拟背景杂波的非结构化、随机性特征。

设量测来自目标的概率为$P_T$，来自杂波的概率为 $P_C = 1 - P_T$。在此基础上，本报告需要完成以下任务：

1. **混合采样生成散点图**：
   对 $P_T = 0.9,\ 0.5,\ 0.1$ 三种情况，分别生成 500 个时刻的雷达量测，每个量测点依据 $P_T$ 和 $P_C$的概率从上述两个分布中采样。绘制其对应的二维散点图，以观察目标与杂波在不同比例下的混合分布特征。

2. **线性加权采样生成散点图**：
   对相同的 $P_T$ 值，考虑如下线性组合生成的量测：
   $$
   z = P_T x + P_C y
   $$
   其中 $x \sim \mathcal{N}([0,0]^T, \text{diag}(25,25))$表示目标点采样，$y \sim \mathcal{U}([-10,-10], [10,10])$ 表示杂波点采样。绘制 500 个此类 $z$ 值组成的散点图，用以对比线性组合生成机制与混合采样机制下的分布差异。

3. **机制差异分析**：
   通过观察上述两类散点图的分布形态，分析不同生成机制（混合采样与线性组合）对雷达量测分布的影响，理解其背后的概率模型和物理意义。


### 二、研究方案:雷达量测建模的两种方式对比——混合模型与线性组合
#### 1. 混合模型（Mixture Model）

* **实现逻辑**：
  每个雷达量测独立选择来源（目标或杂波）：

  * 首先根据目标存在概率 $P_T$，为每个样本生成一个随机数，若该数小于 $P_T$，则该样本判定为"目标"；否则为"杂波"；
  
  * 对于目标样本，采用二维高斯分布进行采样：
    $$
    \mathbf{x}_\text{target} \sim \mathcal{N}(\boldsymbol{\mu}, \boldsymbol{\Sigma})
    $$
    
  * 对于杂波样本，采用二维均匀分布采样：
    $$
    \mathbf{x}_\text{clutter} \sim \mathcal{U}([a_1, a_2], [b_1, b_2])
    $$
    
  * 目标和杂波样本在二维平面中分别可视化，表示混合结构。

#### 2. 线性组合模型（Linear Combination Model）

* **实现逻辑**：
  所有量测样本为目标信号与杂波信号的线性叠加：

  * 分别独立生成来自高斯分布和均匀分布的样本：

    $$
    \mathbf{x} \sim \mathcal{N}(\boldsymbol{\mu}, \boldsymbol{\Sigma}), \quad 
    \mathbf{y} \sim \mathcal{U}([a_1, a_2], [b_1, b_2])
    $$
  * 然后按照概率权重进行线性组合得到混合样本：

    $$
    \mathbf{z} = P_T \cdot \mathbf{x} + P_C \cdot \mathbf{y}, \quad \text{其中 } P_C = 1 - P_T
    $$
  * 此方法在保留目标统计特性的同时，引入杂波扰动，从而反映目标信息受干扰的程度。

#### 3. 可视化与代码结构(py)

* **参数设置**：

  ```python
  n_samples = 500  # 样本总数
  pT_values = [0.9, 0.5, 0.1]  # 三种目标概率
  mean = [0, 0]                # 高斯均值
  cov = [[25, 0], [0, 25]]     # 高斯协方差（对角）
  a, b = [-10, -10], [10, 10]  # 均匀分布范围

- **核心函数结构**：

  ```
  def plot_mixture_model(ax, pT):          # 混合模型绘图函数
  def plot_linear_combination(ax, pT):     # 线性组合模型绘图函数
  ```

- **子图绘制与布局**：

  ```
  for idx, pT in enumerate(pT_values):
      plot_mixture_model(axes[0, idx], pT)         # 第一行：混合模型
      plot_linear_combination(axes[1, idx], pT)    # 第二行：线性组合模型
  ```

#### 4. 三维扩展展示（高纬度）

- 若希望更直观地区分类别信息，可使用三维散点图对模型进行可视化：
  - 对于混合模型，可设定 $z=1$ 表示目标样本，$z=0$ 表示杂波；
  - 对于线性组合，可统一设定 $z=0.5$ 作为中性高度；
  - 利用 `matplotlib` 的 `3D scatter` **实现高度维度上的区分与增强展示**。

### 三、实验结果及分析
#### 1. 混合模型与线性组合对比图
![](D:\Desktop\随机过程\大作业一\Figure_1.png)

![](D:\Desktop\随机过程\大作业一\Figure_2.png)



#### 2. 混合模型结果分析

在混合模型中，样本来源分为两部分：一类为目标信号，服从以原点为均值、协方差为单位阵的二维正态分布；另一类为背景杂波，服从在区域 $[-10,10]\times[-10,10]$ 内均匀分布的随机变量。两类样本以目标存在概率 $P_T$ 作为混合权重生成，体现出雷达信号“目标 + 干扰”成分的经典结构。通过调整 $P_T$，可以直观模拟目标信号强度变化所带来的分布变化特征。

- **高 $P_T$ 值（$P_T = 0.9$）**：
   红色目标样本数量占绝对主导，散点图呈现密集聚集于原点附近的高斯分布结构。背景杂波（蓝色点）虽然仍存在，但数量稀少，仅零星分布在图像外围，对整体分布密度影响甚微，几乎可视为“纯净信道”下的理想检测场景。该状态下，雷达系统可轻松识别出目标特征，为目标检测算法提供上限性能评估。
- **中 $P_T$ 值（$P_T = 0.5$）**：
   目标与干扰数量相当，图像呈现典型的双结构特征——中心区域保持高斯样式的密集红色目标点，而边缘区域则由均匀分布的蓝色杂波点占据。这种情形下，干扰开始对检测性能构成威胁，目标检测算法需要更具鲁棒性与自适应能力。此状态非常适合用于测试算法在中等信噪比背景下的泛化能力与误警率控制能力。
- **低 $P_T$ 值（$P_T = 0.1$）**：
   杂波成为主导，蓝色点几乎铺满整个观测区域，模拟出高强度干扰环境下的复杂背景。仅有少量红色目标点出现在中心区域，易被蓝色背景“淹没”。此类极端情境是雷达系统设计中的关键挑战，需依赖先进信号处理方法（如空间滤波、CFAR检测、深度学习）实现对低信噪比目标的有效挖掘。
- **可视化结论**：
   整体而言，混合模型在**样本层面**对目标与杂波进行了清晰建模，其随机生成的散点图可呈现出从“目标主导”到“干扰主导”的连续变化趋势，为雷达系统在多种复杂场景下提供了具代表性的模拟样本。这种建模方式不仅符合实际物理机制，也为算法调试与评估提供了灵活控制的实验平台。

#### 3. 线性组合模型结果分析

线性组合模型采用的生成方式不同于混合模型：每个样本点的坐标 $X$ 由目标分布样本 $X_T$ 与干扰分布样本 $X_C$ 通过线性加权生成，即：
$$
X = P_T \cdot X_T + (1-P_T) \cdot X_C
$$
这种方式本质上是一种**特征级别的融合**，即将目标与杂波视为连续可调的两个信号源，在生成样本时对其特性进行加权平均处理。

- **高 $P_T$ 值（$P_T = 0.9$）**：
   样本点整体分布依然接近正态分布，体现出高目标权重下的信号主导特征。然而由于部分均匀分布成分的介入，散点图的边缘出现一定程度的“拉伸”现象，分布边界比理想高斯更宽。此现象对应实际中雷达回波存在轻微背景干扰或传播多径的场景，具有一定现实意义。
- **中低 $P_T$ 值（$P_T = 0.5$ 或 $0.1$）**：
   样本点分布逐渐趋向均匀，空间扩散性增强，中心聚集性减弱。但由于高斯成分的连续介入，即使 $P_T$ 较低，中心区域仍有轻微密度提升，显示出“残余高斯”效应。该现象意味着：线性组合并不会彻底“去除”目标特征，而是使其逐渐弱化、过渡性融合到干扰中。
- **对比分析与建模局限**：
   与混合模型不同，线性组合模型并不能清晰地区分目标与杂波样本的来源，其本质是一种信号混合，而非样本分离。其结果表现出一种**“中间态”分布特性**——在不同 $P_T$ 下连续过渡、缺乏明确界限。这种“模糊态”虽然有助于模拟弱目标信号在杂波背景中的微弱影响，但却不适合用于目标检测任务中的决策边界学习、目标标签标注等操作。

#### 核心差异汇总对比

| **属性**     | **混合模型**                       | **线性组合模型**                 |
| ------------ | ---------------------------------- | -------------------------------- |
| 样本生成方式 | 源分布独立采样，按概率合并样本     | 单个样本由两个分布按概率加权融合 |
| 样本独立性   | 严格独立，红蓝样本源可追踪         | 样本间不可分离，来源混杂         |
| 信号表达方式 | 样本层级合成，目标与干扰可视化分明 | 特征层级融合，信号混合为连续体   |
| 可分性       | 决策边界清晰，支持标签训练         | 无法清晰分类，难以用于监督学习   |
| 分布结构     | 双峰特征明显，分布层级丰富         | 单一分布形式，连续过渡性特征明显 |
| 工程适用性   | 多目标检测、抗干扰测试             | 微弱目标建模、信号扰动分析       |



通过以上分析可以看出，混合模型适用于模拟**结构清晰、信号独立**的雷达场景，更贴近雷达系统“目标+杂波”的物理结构，适用于监督学习与目标检测；而线性组合模型更适合模拟**连续变化、信号融合**的灰度场景，对算法的泛化性与鲁棒性测试更有参考意义。

### 四、结论
本报告围绕雷达测量数据的模拟问题，对混合模型与线性组合模型在不同目标概率条件下的表现进行了深入探讨。通过理论建模和可视化分析，不仅观察到了概率参数对数据分布的影响，更重要的是发现了两种建模方法在物理意义和应用场景上的本质差异。这些发现对实际雷达系统的数据模拟和目标检测具有重要参考价值。

从建模原理的角度来看，两种模型的设计思路反映了对雷达信号不同的理解方式。混合模型采用了"分而治之"的策略，将目标和杂波分开生成后再合并。这种做法看似繁琐，实则抓住了雷达信号处理的本质特征——在实际应用中，我们往往需要明确区分目标信号和背景杂波。通过可视化结果可以清晰看到，红色目标点在中心区域形成明显的聚集，而蓝色杂波点则均匀散布，这种直观的分布特征非常有利于后续的目标检测算法开发。相比之下，线性组合模型将两种成分通过线性加权的方式融合，虽然在数学表达上更为简洁，但这种"一锅烩"的做法模糊了信号来源的物理意义，在实际应用中可能会带来解释性方面的问题。

在实验表现方面，我注意到目标概率对模型输出的影响非常显著。当目标概率较高时，两种模型的输出都呈现出以高斯分布为主的形态，差异不大。但随着目标概率的降低，混合模型的优势逐渐显现：它能真实再现目标信号被杂波淹没的场景，这对测试雷达系统在强干扰环境下的性能至关重要。而线性组合模型在低目标概率时，仍然保留了过多的高斯特性，导致模拟结果与实际场景存在偏差。这个发现提示我们，在杂波占主导的复杂电磁环境中，混合模型可能是更合适的选择。

特别值得关注的是目标概率参数的敏感性分析。我发现这个参数不仅简单地调节了目标与杂波的数量比例，更重要的是它改变了整个数据分布的空间特性。当目标概率接近边界值（0或1）时，两种模型的差异会被放大，这说明在实际应用中必须谨慎设置这个参数。我们的实验表明，混合模型对参数变化的响应更符合物理直觉，这为参数调试提供了便利。

基于以上分析，我认为混合模型因其清晰的物理意义和灵活的参数调控能力，特别适合作为雷达目标检测算法的测试基准。它不仅能够模拟单一目标场景，还可以通过扩展来构建多目标、多干扰源的复杂环境。而线性组合模型虽然在理论分析中具有一定优势，但在实际应用中可能需要额外的处理才能达到理想效果。这种差异启示我们：在工程实践中，模型的选择不能仅考虑数学上的简洁性，更需要考虑其物理可解释性和场景适应性。未来工作中，我们还可以探索将两种模型优势结合的新型建模方法，以更好地服务于不同的应用需求。

