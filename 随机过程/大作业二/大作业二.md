## 大作业二：中心极限定理验证实验

### 一、题目分析

**中心极限定理（Central Limit Theorem, CLT）**是概率论中最为核心的定理之一，也是统计学诸多推断方法赖以成立的理论基石。其核心思想在于：即便原始总体分布形态未知或显著偏离正态，只要满足一定的条件（如独立性、同分布、有限方差等），随着样本容量$n$的增加，样本均值的分布将趋近于正态分布。这意味着**正态性不再取决于原始分布，而是由抽样机制本身所"塑造"**，反映出统计规律性在随机性中的宏观体现。

该定理在现代统计实践中具有广泛应用，例如：置信区间估计、显著性检验、误差分析等，几乎所有基于均值的推断方法都隐含或直接使用了中心极限定理作为理论前提。本实验结合**蒙特卡洛模拟**与**数据可视化技术**，系统检验中心极限定理对不同分布情形的适用性与收敛速度差异。通过精心选取六类常见分布，模拟不同样本容量下的样本均值分布形态，辅以核密度估计和理论正态曲线对比，为理论的数值验证提供直观支撑，也体现了统计模拟方法在教学和研究中的实用价值。

### 二、实验目标

本次实验聚焦于以下三个核心研究目标，旨在通过定量与定性相结合的方式，全面验证中心极限定理的普遍性和有效性：

1. **分布多样性验证**：
   为避免验证结果局限于特定分布形式，实验选取六种典型分布作为研究对象，涵盖连续分布与离散分布、对称型与偏态型、有限定义域与无限定义域等多样情形。具体包括：
   - **均匀分布 $U(0,1)$**：连续型、对称、有限支持
   - **指数分布 $Exp(\lambda=1)$**：连续型、右偏、无界
   - **二项分布 $B(1,0.5)$**：离散型、对称、有限取值
   - **泊松分布 $Poisson(\lambda=3)$**：离散型、右偏、无限取值
   - **卡方分布 $\chi^2(df=2)$**：连续型、右偏、正偏斜严重
   - **贝塔分布 $Beta(a=2,b=5)$**：连续型、偏态、有限支持
   
2. **收敛过程观测**：
   设定一组代表性的样本容量值：$n \in \{1, 2, 5, 10, 30, 50, 100\}$，覆盖从极小样本到中等样本量的转变过程。在每个$n$值下，进行10,000次独立重复采样，记录其样本均值，形成该样本容量下的样本均值分布图像。

3. **量化分析方法**：
   采用**Seaborn的核密度估计（KDE）**绘制样本均值的概率密度图，并叠加对应的理论正态分布曲线$N(\mu, \sigma^2/n)$，以实现直观的视觉对比。

### 三、数学理论基础

#### 1. 定理表述

中心极限定理的经典形式可以表述如下：

设$\{X_1, X_2, ..., X_n\}$为来自某总体分布的独立同分布随机变量，假设其数学期望$\mu$和方差$\sigma^2$有限，则当样本容量$n$充分大时，样本均值$\bar{X}_n$满足如下收敛性质：

$$
\frac{\bar{X}_n - \mu}{\sigma/\sqrt{n}} \xrightarrow{d} N(0,1)
$$

#### 2. 数学推导简述

根据概率论中的李雅普诺夫中心极限定理、林德伯格定理等，可以进一步放宽条件（如非完全同分布）仍可实现相似结论。我们关注最基础的独立同分布情形，强调以下重要结论：

- 样本均值的期望仍为$\mu$，方差缩小为$\sigma^2/n$
- 收敛速度通常为$\mathcal{O}(1/\sqrt{n})$，即样本容量增加一倍，误差缩小为原来约70%

因此，对于有限$n$时，我们近似认为：

$$
\bar{X}_n \approx N\left(\mu, \frac{\sigma^2}{n}\right)
$$

### 四、实验设计与实现

为了深入理解中心极限定理的适用范围和收敛速度，本实验通过对不同分布类型的抽样模拟与样本均值分析，验证其向正态分布收敛的过程。整个实验分为参数配置、代码实现和可视化分析三个部分，具体设计如下。

#### 1. 实验参数配置

本实验力求在覆盖典型分布类型的基础上，观察不同初始分布下样本均值的收敛趋势。因此在实验参数设置方面，兼顾了广度与深度：

| 参数类别     | 具体设置                                  | 设置理由                 |
| ------------ | ----------------------------------------- | ------------------------ |
| 重复实验次数 | $N = 10000$ 次                            | 保证统计结果稳定、波动小 |
| 样本容量序列 | $n = {1, 2, 5, 10, 30, 50, 100}$          | 展示收敛过程的动态演化   |
| 分布类型     | 6种（均匀、指数、二项、泊松、卡方、贝塔） | 代表不同偏态与离散程度   |
| 随机数算法   | NumPy 默认的 Mersenne Twister 算法        | 高效且可重复性强         |

该设置不仅能体现中心极限定理“广泛适用”的特点，还能考察其在极端分布条件下的收敛速度与效果，具有较强的代表性。

#### 2. 核心代码模块说明

为实现模块化、可重复性强的实验过程，代码主要分为三个核心模块，分别负责生成分布样本、计算样本均值并绘图分析。

##### （1）分布生成模块

该模块负责根据预设的分布函数，生成指定样本容量的原始样本。每个分布都定义为一个 Lambda 函数，可灵活传参调用。

```
distributions = {
    'Uniform(0,1)': lambda n: np.random.rand(n),
    'Exponential(λ=1)': lambda n: np.random.exponential(1, n),
    'Binomial(n=1,p=0.5)': lambda n: np.random.binomial(1, 0.5, n),
    'Poisson(λ=3)': lambda n: np.random.poisson(3, n),
    'Chi-squared(df=2)': lambda n: np.random.chisquare(2, n),
    'Beta(a=2,b=5)': lambda n: np.random.beta(2, 5, n)
}
```

**设计说明：** 选取的分布覆盖了连续与离散、对称与偏态、轻尾与重尾等常见特征，有助于检验中心极限定理在多种真实情形下的表现。

##### （2）样本均值计算模块

对每个分布及样本容量，通过重复抽样计算样本均值，形成一组近似分布。每一轮实验模拟一次“样本均值观测”，共进行 $N=10000$ 次：

```
sample_means = np.zeros(num_experiments)
for i in range(num_experiments):
    sample = dist_func(n)
    sample_means[i] = np.mean(sample)
```

**设计说明：** 使用 NumPy 的向量化特性提升效率，并确保每次实验随机性足够，避免伪收敛现象。最终得到的是一个近似于“样本均值分布”的序列，用于与正态分布对比。

##### （3）可视化与对比模块

通过 Seaborn 绘制样本均值的直方图及核密度估计曲线，并叠加理论正态分布曲线进行拟合验证：

```
sns.histplot(sample_means, kde=True, stat="density", bins=30)
x = np.linspace(min(sample_means), max(sample_means), 100)
pdf = norm.pdf(x, loc=np.mean(sample_means), scale=np.std(sample_means))
plt.plot(x, pdf, 'r--', label='Theoretical Normal')
```

**设计说明：**

- 直方图用于展示样本均值的经验分布；
- KDE曲线用于平滑显示概率密度；
- 理论正态曲线用红色虚线标出，直观判断其拟合程度。

此外，还在每组图中标注样本容量与偏度（Skewness）指标，进一步观察正态性的改善过程。

### 五、实验结果分析

![](D:\Desktop\随机过程\大作业二\Figure_1.png)

![Figure_2](D:\Desktop\随机过程\大作业二\Figure_2.png)

#### 1. 收敛速度比较

| 分布类型 | 近似正态所需最小样本容量$n$ | 特征描述                                 |
| :------- | :-------------------------- | :--------------------------------------- |
| 均匀分布 | $n \geq 10$                 | 起始即为对称分布，均值分布快速收敛       |
| 二项分布 | $n \geq 30$                 | 离散型导致小样本时分布不连续             |
| 泊松分布 | $n \geq 50$                 | 偏态性存在，需更大样本量弥合偏态特征     |
| 指数分布 | $n \geq 50$                 | 明显右偏，随着$n$增加才逐渐对称          |
| 卡方分布 | $n \geq 50$                 | 偏斜性强，小样本阶段难以近似正态         |
| 贝塔分布 | $n \geq 30$                 | 有界性影响初期分布形态，后期收敛表现良好 |

#### 2. 异常与边界现象发现

- **小样本悖论现象**：
   当$n=1$时，样本均值即为单次样本值，因此其分布与原始总体完全一致。例如，对于$B(1,0.5)$的二项分布，其结果只有0或1两种，因此样本均值分布是典型的二点分布。这一特征直观反映了样本均值的原始依赖性。
- **贝塔分布的边界效应**：
   贝塔分布定义在区间[0,1]，当$n$较小时，样本均值分布也受到定义域限制，呈现明显的边界截断和偏斜现象。但随着$n$的增大，边界效应逐渐被削弱，分布主体向中心集中，呈现出理想的正态形态。
- **离散→连续转化趋势**：
   泊松与二项等离散分布在样本均值叠加后，逐渐表现出“连续性”。这说明中心极限定理不仅适用于连续分布，也对离散分布中的均值变量具有显著效果。

### 六、实验总结与反思

通过本次“中心极限定理验证”实验，我对这一定理的理解不再停留在书本的定义或课本上的数学推导，而是通过亲手编程和直观观察，真实地“看见”了它的威力和普适性。无论原始数据是偏的、散的、跳跃的，随着样本数量的增加，样本均值分布总是稳稳地趋向于一个漂亮的钟形曲线，这种“最终都会归于正态”的规律性让人感受到统计学背后的深刻哲理。

特别是在实验过程中，当我一开始看到像指数分布、卡方分布那样严重偏态的数据，直觉上很难相信它们的均值竟然也会趋于对称的正态形态。但当样本量增大时，这种偏态逐渐被“平均”掉，均值分布居然开始变得越来越“对称、平滑”，这一变化过程通过图像展示尤为震撼，也真正体现了“样本均值有记忆，而个体的极端性会被稀释”的思想。

从实践角度来说，这也让我明白了：在现实数据分析中，只要采样足够充分，我们就有理由借助正态分布来进行推断、估计、检验。这大大降低了模型设计的复杂性，也增强了对数据结果的信心。实验中采用的蒙特卡洛方法，更是体现了“用计算模拟理论”的思路，让复杂的数学概念变得可以“做出来”“画出来”，这种方式对我以后从事数据分析、算法设计甚至科研写作都有很大的启发。

此外，我还体会到“样本容量”的重要意义。中心极限定理虽然普遍成立，但其“收敛速度”与原始分布的特性息息相关。有些分布（如均匀分布）收敛很快，有些（如指数、卡方）则需要更大的样本量才能“看出规律”。这提示我们在应用中不能一味依赖“正态假设”，而应该根据数据特征合理选择分析方法。本次实验不仅帮助我加深了对中心极限定理的理解，也锻炼了我在实际编程、数据模拟和可视化表达方面的能力。数学理论与实际编程的结合，让我更真切地体会到了统计规律背后的力量。
